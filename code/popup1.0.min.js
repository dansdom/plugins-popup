/*
	jQuery Popup Plugin 
	Copyright (c) 2011 Daniel Thomson
	
	Licensed under the MIT license:
	http://www.opensource.org/licenses/mit-license.php
*/

(function(a){a.fn.popup=function(c){var b={transparentLayer:true,gallery:false,galleryTitleHeight:30,galleryControlHeight:40,autoSize:true,boxWidth:400,boxHeight:300,centerImage:true,shadowLength:42,transition:500,popupClass:"popupBox",contentClass:"popupContent",closeBox:"popupClose",centerOnResize:true};b&&a.extend(b,c);this.each(function(){var d=a(this);a(d).click(function(){d.boxSrc=a(this).attr("name");d.galleryTitle=a(this).attr("title");a.fn.popup.createBox(b);var f=a.fn.popup.findScreenPos(); d.screenHeight=f.screenHeight;d.screenWidth=f.screenWidth;d.scrollHeight=f.scrollHeight;d.scrollWidth=f.scrollWidth;a.fn.popup.isContentImage(d)?a.fn.popup.displayImage(d,b):a.fn.popup.styleNodeBox(d,b);return false})});return this};a.fn.popup.findScreenPos=function(){var c={};if(typeof window.innerHeight=="number"){c.screenHeight=window.innerHeight;c.screenWidth=window.innerWidth;c.scrollHeight=window.pageYOffset;c.scrollWidth=window.pageXOffset}else if(document.documentElement&&document.documentElement.clientHeight){c.screenHeight= document.documentElement.clientHeight;c.screenWidth=document.documentElement.clientWidth;c.scrollHeight=document.documentElement.scrollTop;c.scrollWidth=document.documentElement.scrollLeft}else if(document.body&&document.body.clientHeight){c.screenHeight=document.body.clientHeight;c.screenWidth=document.body.clientWidth;c.scrollHeight=document.body.scrollTop;c.scrollWidth=document.body.scrollLeft}return c};a.fn.popup.createBox=function(c){if(a("."+c.popupClass).length==0){var b='<div class="'+c.popupClass+ '"><div class="popupTop"><div class="popupTL corner"></div><div class="popupTM"></div><div class="popupTR corner"></div></div><div class="popupMid"><div class="popupML"></div><div class="'+c.contentClass+'"><p>something</p></div><div class="popupMR"></div></div><div class="popupBot"><div class="popupBL corner"></div><div class="popupBM"></div><div class="popupBR corner"></div></div></div>';a("body").append(b);a("."+c.popupClass).css("display","none");if(c.transparentLayer==true&&a(".transparency").length== 0){a("body").append('<div class="transparency" style="z-index:99;background:#000;opacity:0.5;filter:alpha(opacity = 50);height:100%;width:100%;top:0;left:0;position:absolute"></div>');window.onscroll=function(){var d=a.fn.popup.findScreenPos();a(".transparency").css({height:d.screenHeight+d.scrollHeight,width:d.screenWidth+d.scrollWidth})};window.onresize=function(){var d=a.fn.popup.findScreenPos();a(".transparency").css({height:d.screenHeight+d.scrollHeight,width:d.screenWidth+d.scrollWidth})}}}document.onkeydown= function(d){var f;if(window.event)f=window.event.keyCode;else if(d)f=d.which;if(f==27){a("."+c.popupClass).stop().fadeOut("slow").css("display","none");a(".transparency").fadeOut("slow")}};a(".transparency").click(function(){a(this).fadeOut("slow");a("."+c.popupClass).fadeOut("slow")});a("."+c.popupClass+" ."+c.contentClass).children().remove();a(".transparency").css({display:"block",filter:"alpha(opacity = 50)"})};a.fn.popup.styleBox=function(c,b,d,f){var e="."+b.popupClass,g="."+b.contentClass+ " img";if(f){a(g).attr("src",f.src);a(g).attr("height",d.imgHeight);a(g).attr("width",d.imgWidth)}if(d){f=d.imgHeight+b.galleryTitleHeight+b.galleryControlHeight;g=d.imgWidth;if(b.autoSize==false){f=b.boxHeight+b.galleryTitleHeight+b.galleryControlHeight;g=b.boxWidth}}else{f=b.boxHeight;g=b.boxWidth}var h=g+b.shadowLength*2,j=f+b.shadowLength*2,i=a.fn.popup.centerBox(c,h,j);c=i.leftPos;i=i.topPos;if(b.centerOnResize==true)window.onresize=function(){var k=a.fn.popup.findScreenPos();k=a.fn.popup.centerBox(k, h,j);a(e).css({top:k.topPos,left:k.leftPos})};if(a(e).css("display")=="block"&&d&&b.autoSize==true){var l=parseFloat(a(e).css("height"))-b.shadowLength*2-(b.galleryTitleHeight+b.galleryControlHeight),m=parseFloat(a(e).css("width"))-b.shadowLength*2;a(e+" img").css({height:l,width:m});a(e+" img").animate({height:d.imgHeight,width:d.imgWidth},b.transition);a(e).animate({height:j,width:h},{queue:false,duration:b.transition});a(e+" .popupContent").animate({height:f,width:g},{queue:false,duration:b.transition}); a(e+" .galleryTitle").css({height:b.galleryTitleHeight});a(e+" .galleryControls").css({height:b.galleryControlHeight,overflow:"hidden"});a(e+" .imgPane").animate({height:f-b.galleryTitleHeight-b.galleryControlHeight},{queue:false,duration:b.transition});a(e+" .popupMid").animate({height:f},{queue:false,duration:b.transition});a(e+" .popupML").animate({height:f,width:b.shadowLength},{queue:false,duration:b.transition});a(e+" .popupMR").animate({height:f,width:b.shadowLength},{queue:false,duration:b.transition}); a(e+" .popupTop").animate({height:b.shadowLength,width:h},{queue:false,duration:b.transition});a(e+" .popupBot").animate({height:b.shadowLength,width:h},{queue:false,duration:b.transition});a(e+" .corner").animate({height:b.shadowLength,width:b.shadowLength},{queue:false,duration:b.transition});a(e+" .popupTM").animate({height:b.shadowLength},{queue:false,duration:b.transition});a(e+" .popupBM").animate({height:b.shadowLength},{queue:false,duration:b.transition});a(e+" .popupTM").css("margin","0 "+ b.shadowLength+"px");a(e+" .popupBM").css("margin","0 "+b.shadowLength+"px");a(e).animate({left:c,top:i},{queue:false,duration:b.transition})}else{a(e).css({height:j,width:h,position:"absolute","z-index":100,overflow:"hidden"});a(e+" .popupContent").css({height:f,width:g,overflow:"hidden","float":"left"});a(e+" .galleryTitle").css({height:b.galleryTitleHeight,overflow:"hidden",position:"relative"});a(e+" .galleryControls").css({height:b.galleryControlHeight,overflow:"hidden"});a(e+" .imgPane").css({height:f- b.galleryTitleHeight-b.galleryControlHeight});a(e+" .popupMid").css({height:f});a(e+" .popupML").css({height:f,width:b.shadowLength,position:"relative","float":"left"});a(e+" .popupMR").css({height:f,width:b.shadowLength,position:"relative","float":"left"});a(e+" .popupTop").css({height:b.shadowLength,width:h,position:"relative"});a(e+" .popupBot").css({height:b.shadowLength,width:h,position:"relative",clear:"both"});a(e+" .corner").css({height:b.shadowLength,width:b.shadowLength,position:"absolute"}); a(e+" .popupTM").css({height:b.shadowLength,margin:"0 "+b.shadowLength+"px"});a(e+" .popupBM").css({height:b.shadowLength,margin:"0 "+b.shadowLength+"px"});a(e+" .popupTL").css({top:"0",left:"0"});a(e+" .popupTR").css({top:"0",right:"0"});a(e+" .popupBL").css({bottom:"0",left:"0"});a(e+" .popupBR").css({bottom:"0",right:"0"});a(e).css("left",c);a(e).css("top",i)}a(e).fadeIn("slow")};a.fn.popup.centerBox=function(c,b,d){this.leftPos=(c.screenWidth-b)/2+c.scrollWidth;this.topPos=(c.screenHeight-d)/ 2+c.scrollHeight;if(this.topPos<0)this.topPos=0;if(this.leftPos<0)this.leftPos=0;return this};a.fn.popup.isContentImage=function(c){c=c.boxSrc.split(".");ext=c[c.length-1];switch(ext){case "jpg":c=true;break;case "gif":c=true;break;case "png":c=true;break;case "bmp":c=true;break;default:c=false}return c};a.fn.popup.displayImage=function(c,b){var d="."+b.popupClass+" ."+b.contentClass;a(d).append('<div class="imgPane"><img src="" width="" height="" alt="" /></div>');if(b.autoSize==false&&b.centerImage== true){a(d+" .imgPane").prepend("<span style='display:inline-block;height:"+b.boxHeight+"px;line-height:"+b.boxHeight+"px'>&nbsp;</span>");a(d+" .imgPane").css({"line-height":b.boxHeight,"text-align":"center"});a(d+" .imgPane img").css({display:"inline","vertical-align":"middle"})}if(b.gallery==true)if(c.galleryTitle!=false){a(d).append('<div class="galleryControls"><ul><li><a href="" class="prev">previous</a></li><li><a href="" class="next">next</a></li></ul></div>');a(d).prepend('<div class="galleryTitle"><h2>'+ c.galleryTitle+'</h2><a href="" class="'+b.closeBox+'">close</a></div>')}else a(d).prepend('<div class="galleryTitle"><a href="" class="'+b.closeBox+'">close</a></div>');var f=new Image,e={};f.onload=function(){e.imgHeight=f.height;e.imgWidth=f.width;a.fn.popup.styleBox(c,b,e,f)};f.src=c.boxSrc;a.fn.popup.addCloseButton(c,b);a.fn.popup.addGalleryControls(c,b)};a.fn.popup.styleNodeBox=function(c,b){var d=a(c.boxSrc).clone();a("."+b.popupClass+" ."+b.contentClass).append('<div class="galleryTitle"><a href="" class="'+ b.closeBox+'">close</a></div>');a("."+b.popupClass+" ."+b.contentClass).append(d);a("."+b.popupClass+" ."+b.contentClass+" "+c.boxSrc).css("display","block");a.fn.popup.styleBox(c,b);a.fn.popup.addCloseButton(c,b)};a.fn.popup.addGalleryControls=function(c,b){a("."+b.popupClass+" .next").click(function(){a.fn.popup.cycleImage(c,b,1);return false});a("."+b.popupClass+" .prev").click(function(){a.fn.popup.cycleImage(c,b,-1);return false});document.onkeydown=function(d){var f;if(window.event)f=window.event.keyCode; else if(d)f=d.which;if(f==39){a(document).unbind();a("."+b.popupClass+" .next").click()}else if(f==37){a(document).unbind();a("."+b.popupClass+" .prev").click()}f==27&&a.fn.popup.closeBox(c,b)}};a.fn.popup.addCloseButton=function(c,b){a("."+b.popupClass+" ."+b.closeBox).click(function(){a.fn.popup.closeBox(c,b);return false})};a.fn.popup.closeBox=function(c,b){a("."+b.popupClass).stop().fadeOut("slow").css("display","none");a(".transparency").fadeOut("slow")};a.fn.popup.cycleImage=function(c,b,d){var f= a("img[title='"+c.galleryTitle+"']").index(c);b=a("img[title='"+c.galleryTitle+"']").length;d=f+d;if(d<0)d=b-1;if(d==b)d=0;a("img[title='"+c.galleryTitle+"']:eq("+d+")").click()}})(jQuery);